<!DOCTYPE html>
<meta charset="utf-8">
<head>
<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
<script src="/datamaps.world.min.js"></script>

<script src="HelperFunctions.js"></script>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script src="http://d3js.org/queue.v1.min.js"></script>
<script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>

</head>

<body>
  <div id="container" style="position: relative; width: 1500px; height: 900px;"></div>

  <script type="text/javascript">
      //var map = new Datamap({element: document.getElementById('container')});
      var countries=['(American)','(Austrian)',"(Russian)"]
      var countForEachCountry={"(American)":0,'(Austrian)':0,"(Russian)":0};
      //console.log(countForEachCountry["(American)"])
      //queue()
        //.defer(d3.csv, "moma.csv")
        //.defer(d3.json, "us.json")
        //.await(ready);
      d3.csv("moma.csv",function(data){
        for(let idx in data){
          let artWorkData = data[idx];
          for(let i in countries){
            if(artWorkData.Nationality==countries[i]){
              countForEachCountry[countries[i]]= countForEachCountry[countries[i]]+1;
              
            }
          }
  
          //console.log(countries[1])
        }
      var bubble_map = new Datamap({
        element: document.getElementById("container"),
        scope: 'world',
        geographyConfig: {
            popupOnHover: false,
            highlightOnHover: false
        },
        fills: {
        'USA': '#1f77b4',
        'RUS': '#9467bd',
        'AUT': '#ff7f0e',
        defaultFill: '#6e6e6e'
        },
        data: {
        'USA': {fillKey: 'USA'},
        'RUS': {fillKey: 'RUS'},
        'AUT': {fillKey: 'PRC'}
        }
        
      });
      
      bubble_map.bubbles([
        {
          radius: 15,
          count: countForEachCountry["(Austrian)"],
          country: 'AUT',
          centered: 'AUT',
          fillKey: 'AUT'
        },
        {
          radius: 25,
          count: countForEachCountry["(American)"],
          country: 'USA',
          centered: 'USA',
          fillKey: 'USA',
        },{
          radius: 70,
          count: countForEachCountry["(Russian)"],
          centered: 'RUS',
          country: 'USSR',
          fillKey: 'RUS',
        }
      ], {
        popupTemplate: function(geo, data) {
          console.log(data)
          return '<div class="hoverinfo">Artwork:' + data.count + ' in '  + data.country + ''
        }
      });
    

        //var symbols =
      });

      //function ready(error,sd){
      //  var artWorkData = sd;
      //  var symbols= drawMap(artWorkData);
      //}

  </script>
</body>
</html>